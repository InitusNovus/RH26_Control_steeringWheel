/*
 * GtmTimEncoder.c
 *
 *  Created on: 2019. 7. 3.
 *      Author: bigbi_000
 */


/******************************************************************************/
/*----------------------------------Includes----------------------------------*/
/******************************************************************************/
#include "HLD.h"
#include <math.h>

/******************************************************************************/
/*-----------------------------------Macros-----------------------------------*/
/******************************************************************************/
#define GTMTIM_ENC			HLD_GtmTim.ch[0]
#define GTMTIM_ENC_RES		(900.0)
/******************************************************************************/
/*--------------------------------Enumerations--------------------------------*/
/******************************************************************************/


/******************************************************************************/
/*-----------------------------Data Structures--------------------------------*/
/******************************************************************************/
typedef struct
{
	float32 speed;
}HLD_GtmTimEncoder_t;

/******************************************************************************/
/*------------------------------Global variables------------------------------*/
/******************************************************************************/
IFX_EXTERN HLD_GtmTim_t HLD_GtmTim;
HLD_GtmTimEncoder_t HLD_GtmTimEncoder =
{
		.speed = 0,
};

/******************************************************************************/
/*-------------------------Function Prototypes--------------------------------*/
/******************************************************************************/


/******************************************************************************/
/*------------------------Private Variables/Constants-------------------------*/
/******************************************************************************/


/******************************************************************************/
/*-------------------------Function Implementations---------------------------*/
/******************************************************************************/
void HLD_GtmTimEncoder_run_1ms(void)
{
	HLD_GtmTimEncoder.speed = 2*IFX_PI*GTMTIM_ENC.data.pulseHz/GTMTIM_ENC_RES;
}

float32 HLD_GtmTimEncoder_getSpeed(void)
{
	if(isinf(HLD_GtmTimEncoder.speed))
		return 0;
	else
		return HLD_GtmTimEncoder.speed;
}
